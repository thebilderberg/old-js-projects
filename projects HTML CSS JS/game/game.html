<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Document</title>
</head>
<body>
	<canvas height="500" width="500" id="example"></canvas>

	<script>

		const example = document.getElementById("example"), // обращение к тегу
		win     			    = example.getContext('2d'); // создание 2D окна 
		let img 							 = new Image();
		let back 							 = new Image();
		img.src = 'https://opengameart.org/sites/default/files/Green-Cap-Character-16x18.png';
		back.src 							= "https://phonoteka.org/uploads/posts/2021-05/1620171266_20-phonoteka_org-p-piramidi-yegipta-fon-23.jpg";
		// const scale 								   = 2;
		
		plyr = {  // объект игрока

			img_x: 0, // расположение фокуса на изображении
			img_y: 0,

			obj_width: 16, // размеры фокуса на изображении
			obj_height: 18,

			map_x: 20, // расположение объекта на карте
			map_y: 20,

			width: 80, // размеры объекта
			height: 90,

			step: 10,

			run: document.addEventListener("keydown", (event)=> {  // функция движения игрока
				// вниз
				if (event.keyCode == '40') {
					plyr.img_y = 0;
					if (plyr.map_y < 349) {
						plyr.img_x += plyr.obj_width;
  					if (plyr.img_x > 32) {
  						plyr.img_x = 0;
  					};
  					plyr.map_y += plyr.step;
					};
  					if (plyr.map_y >= 349) {
  						plyr.img_x += plyr.obj_width;
  					if (plyr.img_x > 32) {
  						plyr.img_x = 0;
  					};
  					plyr.map_y -= plyr.step;
  					};
				};
				// вниз
				// ------------------------------------------
  				//вверх
  				if (event.keyCode == '38') {
  					plyr.img_y = 18;
					if (plyr.map_y > 0) {
						plyr.img_x += plyr.obj_width;
  						if (plyr.img_x > 32) {
  							plyr.img_x = 0;
  						};
  					plyr.map_y -= plyr.step;
					};
  					if (plyr.map_y <= 0) {
  						plyr.img_x += plyr.obj_width;
  					if (plyr.img_x > 32) {
  						plyr.img_x = 0;
  					};
  					plyr.map_y += plyr.step;
  					};
				};
				// вверх
				//----------------------------------------
				//вправо
				if (event.keyCode == '39') {
					plyr.img_y = 54;
					if (plyr.map_x < 418) {
						plyr.img_x += plyr.obj_width;
  						if (plyr.img_x > 32) {
  							plyr.img_x = 0;
  						};
  					plyr.map_x += plyr.step;
					};
  					if (plyr.map_x > 417) {
  						plyr.img_x += plyr.obj_width;
  						if (plyr.img_x > 32) {
  							plyr.img_x = 0;
  						};
  					plyr.map_x -= plyr.step;
  					};
				};
				//вправо
				//------------------------------------------
				//влево
				if (event.keyCode == '37') {
					plyr.img_y = 36;
					if (plyr.map_x > 0) {
						plyr.img_x += plyr.obj_width;
  						if (plyr.img_x > 32) {
  							plyr.img_x = 0;
  						};
  					plyr.map_x -= plyr.step;
					};
  					if (plyr.map_x < 1) {
  						plyr.img_x += plyr.obj_width;
  						if (plyr.img_x > 32) {
  							plyr.img_x = 0;
  						};
  					plyr.map_x += plyr.step;
  					};
				};
				//влево
			}), // функция движения игрока

		}; 


		img.onload = function() {  // загружаем изображение из облака в отрисовку
  			draw();
		};

		back.onload = function() {  // загружаем изображение из облака в отрисовку
  			draw();
		};

		
		function draw() {   // отрисовка
			win.drawImage(back, 0, 0, 600, 600);
  			win.drawImage(img, plyr.img_x, plyr.img_y, plyr.obj_width, plyr.obj_height, plyr.map_x, plyr.map_y, plyr.width, plyr.height);
  		requestAnimationFrame(draw);
		};	

		
	</script>
</body>








